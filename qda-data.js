/* Outils de construction des Layers
* 
* un layer = une periode
*
* pour chaque Layer on liste des batiments.
* (On regroupe les batiments par rue pour s'y retrouver)
* 
* chaque batiment doit nous donner :
*  - son emplacement (latitude longitude)
*  - Le texte a afficher au survol
*
*  Pour un meme batiment l'emplacement est toujours le meme
*  en revanche le message change d'une periode a l'autre.
*
* La fonction parseEra permets de construire, a partir 
* de 2 tableaux associatifs, la structure de donnees voulue
* en evitant les repetitions.
*/

/* fonction outil, permettant de faire correspondre 
* le nom de la periode au numero pour l'ancre sur la 
* page triptique (le lien ouvre sur la periode voulue)
*/
function getAnchorIndex(era) {
  let result;
  switch (era) {
   case "Contemporain" :
    result = 1;
    break;
   case "PlacesCont" :
    result = 1;
    break;
   case "Moderne" :
    result = 2;
    break;
   case "PlacesMod" :
    result = 2;
    break;
   case "Historique" :
    result = 3;
    break;
   case "PlacesHist" :
    result = 3;
    break;
  }
  return result;
}

/* prefixe n par zero si inferieur a 10 *
/* ATTENTION NE PAS DEPASSER 99 */
function n(n) {
  return n > 9 ? "" + n: "0" + n;
}

// SET FEATURE STATE NEEDS AN ID !
//https://github.com/mapbox/mapbox-gl-js/issues/6849

function parseStreetEra(street, era) {
/* Cette fonction retourne tous les batiments
* d'une rue seulement et pour une epoque uniquement
* Elle est appellee par la fonction "parseEra" (pas d'autre utilite)
*/
  let strFeatList = [];
  let i = 1;
  for (let bat in eraLayers[era][street]) {
  /* /!\ ici on parcours une rue seulement.
   * On cree une collection de Features (classe geoJSON) :
   * pour chaque batiment, on va inserer un objet dans le tableau (la collection).
   * et on renseigne la localisation et le message correspondant (voir eraLayers)
   */
    let genId = era+"-"+street+"-"+i;
    strFeatList.push( Object.assign( {
     'type'      : 'Feature',
     'properties': {
         "@id": "way/"+genId,
        'description': "<center>num√©ro "+bat+" : </center><br/>"+eraLayers[era][street][bat], 
        'link':        'n-'+n(bat)+street+'/#toggle-id-'+getAnchorIndex(era)
      },
     'geometry'  : { 
        'type': 'Polygon',
        'coordinates': numLoc[street][bat]
      },
      "id": "way/"+genId
    }
    ));
    i += i;
  }
  return strFeatList;
}

function parseEra(era) {
  /* Cette fonction est celle qui permet de remplir un Layer.
  * Il y a un Layer par epoque (era = epoque en anglais).
  *
  * pour chaque rue on va concatener les resultats en un seul tableau
  */
  let eraFeatList = [];
  streets.forEach( function(str) {
    eraFeatList = eraFeatList.concat( parseStreetEra(str, era) );
  });
  return eraFeatList;
}

/* attention le mot const en declare plusieurs :
 * (virgules en fin de ligne a la place du point-virgule)
 */
const

/* ce tableau liste les indices de chaque rues.
 * cela nous garantie de pouvoir faire la correspondance
 * entre numLoc et eraLayers['periode']
 */
streets = ["trans", "marchands", "marche", "herbes"],

/* Fait corespondre chaque batiment a ses coordonnes GPS
 * Ne depends pas des periodes
 */
numLoc = {
 "trans" : {
   "1"     : [ [
            [ 6.466543, 43.538585 ],
            [ 6.466657, 43.538635 ],
            [ 6.466618, 43.538683 ],
            [ 6.466499, 43.538637 ],
            [ 6.466543, 43.538585 ]
          ] ],
   "2"     : [ [
            [ 6.46629, 43.538483 ],
            [ 6.4665, 43.538568 ],
            [ 6.466467, 43.538604 ],
            [ 6.466366, 43.538562 ],
            [ 6.466288, 43.538529 ],
            [ 6.46629, 43.538483 ]
          ] ],
   "3"     : [[
            [ 6.466572, 43.538549 ],
            [ 6.466687, 43.5385991 ],
            [ 6.466657, 43.538635 ],
            [ 6.466543, 43.538585 ],
            [ 6.466572, 43.538549 ]
          ]],
   "4"     : [[
            [ 6.466439, 43.538494 ],
            [ 6.466533, 43.538533 ],
            [ 6.4665, 43.538568 ],
            [ 6.46629, 43.538483 ],
            [ 6.466292, 43.53843 ],
            [ 6.466433, 43.538491 ],
            [ 6.466439, 43.538494 ]
          ]],
//   "5"     : [6.466603, 43.538548],
   "6"     : [[
            [ 6.466533, 43.538533 ],
            [ 6.466439, 43.538494 ],
            [ 6.466484, 43.538438 ],
            [ 6.466583, 43.538481 ],
            [ 6.466533, 43.538533 ]
          ]],
   "7"     : [[
            [ 6.466572, 43.538549 ],
            [ 6.4666177, 43.5384945 ],
            [ 6.4667236, 43.5385446 ],
            [ 6.4668283, 43.5384232 ],
            [ 6.4668571, 43.5384348 ],
            [ 6.46686, 43.538436 ],
            [ 6.466912, 43.538445 ],
            [ 6.467021, 43.538505 ],
            [ 6.466836, 43.538664 ],
            [ 6.4667301, 43.5386179 ],
            [ 6.466687, 43.5385991 ],
            [ 6.466572, 43.538549 ]
          ]],
   "8"     : [[
            [ 6.466583, 43.538481 ],
            [ 6.466484, 43.538438 ],
            [ 6.466437, 43.538417 ],
            [ 6.466472, 43.538375 ],
            [ 6.466618, 43.538441 ],
            [ 6.466583, 43.538481 ]
          ]],
//   "9"     : [6.466778, 43.538509],
   "10"    : [[
            [ 6.466516, 43.538333 ],
            [ 6.466545, 43.538345 ],
            [ 6.466658, 43.538396 ],
            [ 6.466618, 43.538441 ],
            [ 6.466472, 43.538375 ],
            [ 6.466405, 43.538345 ],
            [ 6.466428, 43.538317 ],
            [ 6.466421, 43.538315 ],
            [ 6.466435, 43.538302 ],
            [ 6.466472, 43.538316 ],
            [ 6.466516, 43.538333 ]
          ]],
   "12"    : [[
            [ 6.466627, 43.538179 ],
            [ 6.466792, 43.538269 ],
            [ 6.466762, 43.538296 ],
            [ 6.466677, 43.538251 ],
            [ 6.466594, 43.538208 ],
            [ 6.466627, 43.538179 ]
          ]],
   "14"    :  [[
            [ 6.466792, 43.538269 ],
            [ 6.466627, 43.538179 ],
            [ 6.466729, 43.538085 ],
            [ 6.466817, 43.538134 ],
            [ 6.466804, 43.538145 ],
            [ 6.466881, 43.538191 ],
            [ 6.4668, 43.538262 ],
            [ 6.466792, 43.538269 ]
          ]],
   "18"    : [[
            [ 6.466776, 43.538042 ],
            [ 6.466824, 43.538073 ],
            [ 6.46684, 43.538057 ],
            [ 6.46696, 43.538132 ],
            [ 6.466917, 43.538159 ],
            [ 6.466839, 43.538116 ],
            [ 6.466817, 43.538134 ],
            [ 6.466729, 43.538085 ],
            [ 6.466776, 43.538042 ]
          ]],
   "19"    : [[
            [ 6.466889, 43.538253 ],
            [ 6.467003, 43.538304 ],
            [ 6.467028, 43.538315 ],
            [ 6.467031, 43.538317 ],
            [ 6.467022, 43.538329 ],
            [ 6.467051, 43.538347 ],
            [ 6.467029, 43.538372 ],
            [ 6.466989, 43.53835 ],
            [ 6.466848, 43.538284 ],
            [ 6.466889, 43.538253 ]
          ]],
   "20"    : [[
            [ 6.46696, 43.538132 ],
            [ 6.46684, 43.538057 ],
            [ 6.466824, 43.538073 ],
            [ 6.466776, 43.538042 ],
            [ 6.466811, 43.538014 ],
            [ 6.466832, 43.537996 ],
            [ 6.467005, 43.538104 ],
            [ 6.46696, 43.538132 ]
          ]],
   "21"    : [[
            [ 6.466938, 43.538215 ],
            [ 6.467049, 43.538265 ],
            [ 6.467003, 43.538304 ],
            [ 6.466889, 43.538253 ],
            [ 6.466938, 43.538215 ]
          ]],
   "22"    : [[
            [ 6.467005, 43.538104 ],
            [ 6.466832, 43.537996 ],
            [ 6.466876, 43.537959 ],
            [ 6.466944, 43.538001 ],
            [ 6.466933, 43.53801 ],
            [ 6.467039, 43.53808 ],
            [ 6.467016, 43.538097 ],
            [ 6.467005, 43.538104 ]
          ]],
   "23"    : [[
            [ 6.467049, 43.538265 ],
            [ 6.466938, 43.538215 ],
            [ 6.466995, 43.538173 ],
            [ 6.467091, 43.538229 ],
            [ 6.467054, 43.538262 ],
            [ 6.467053, 43.538261 ],
            [ 6.467049, 43.538265 ]
          ]],
   "24"    : [[
            [ 6.467039, 43.53808 ],
            [ 6.466933, 43.53801 ],
            [ 6.466944, 43.538001 ],
            [ 6.466876, 43.537959 ],
            [ 6.466915, 43.537926 ],
            [ 6.467094, 43.538039 ],
            [ 6.467072, 43.538056 ],
            [ 6.467039, 43.53808 ]
          ]],
   "26"    : [[
            [ 6.466962, 43.537878 ],
            [ 6.467153, 43.537995 ],
            [ 6.467094, 43.538039 ],
            [ 6.466915, 43.537926 ],
            [ 6.466946, 43.537909 ],
            [ 6.466954, 43.537899 ],
            [ 6.466962, 43.537878 ]
          ]],
   "27"    : [[
            [ 6.467147, 43.538209 ],
            [ 6.467045, 43.538139 ],
            [ 6.467096, 43.538104 ],
            [ 6.467104, 43.538109 ],
            [ 6.467195, 43.538179 ],
            [ 6.467147, 43.538209 ]
          ]],
   "28"    : [[
            [ 6.467153, 43.537995 ],
            [ 6.466962, 43.537878 ],
            [ 6.466993, 43.537844 ],
            [ 6.467196, 43.537963 ],
            [ 6.467155, 43.537994 ],
            [ 6.467153, 43.537995 ]
          ]],
   "29"    : [[
            [ 6.467195, 43.538179 ],
            [ 6.467104, 43.538109 ],
            [ 6.46715, 43.538078 ],
            [ 6.467241, 43.538151 ],
            [ 6.467195, 43.538179 ]
          ]],
   "30"    : [[
            [ 6.467196, 43.537963 ],
            [ 6.466993, 43.537844 ],
            [ 6.467035, 43.537799 ],
            [ 6.46718, 43.537872 ],
            [ 6.467257, 43.537918 ],
            [ 6.467196, 43.537963 ]
          ]],
   "31"    : [[
            [ 6.467194, 43.538049 ],
            [ 6.467298, 43.538129 ],
            [ 6.467329, 43.538158 ],
            [ 6.467371, 43.538203 ],
            [ 6.467357, 43.538211 ],
            [ 6.467329, 43.538229 ],
            [ 6.467241, 43.538151 ],
            [ 6.46715, 43.538078 ],
            [ 6.467194, 43.538049 ]
          ]],
 //  "32"    : [6.467250, 43.537885],
   "33"    : [[
            [ 6.467267, 43.53801 ],
            [ 6.467364, 43.538068 ],
            [ 6.467374, 43.538075 ],
            [ 6.46731, 43.53812 ],
            [ 6.467298, 43.538129 ],
            [ 6.467194, 43.538049 ],
            [ 6.467267, 43.53801 ]
          ]],
   "34"    : [[
            [ 6.467369, 43.537832 ],
            [ 6.467292, 43.537891 ],
            [ 6.467075, 43.537757 ],
            [ 6.467088, 43.537744 ],
            [ 6.467099, 43.537734 ],
            [ 6.467119, 43.537717 ],
            [ 6.467148, 43.537695 ],
            [ 6.467369, 43.537832 ]
          ]],
   "34B"   : [[
            [ 6.46719, 43.537663 ],
            [ 6.467406, 43.537802 ],
            [ 6.467369, 43.537832 ],
            [ 6.467148, 43.537695 ],
            [ 6.46719, 43.537663 ]
          ]],
   "36"    : [[
            [ 6.467231, 43.537632 ],
            [ 6.46745, 43.537765 ],
            [ 6.467406, 43.537802 ],
            [ 6.46719, 43.537663 ],
            [ 6.467197, 43.537658 ],
            [ 6.467231, 43.537632 ]
          ]],
   "38"    : [[
            [ 6.46745, 43.537765 ],
            [ 6.467231, 43.537632 ],
            [ 6.467303, 43.537577 ],
            [ 6.46751, 43.53772 ],
            [ 6.46745, 43.537765 ]
          ]],
   "42"    : [[
            [ 6.467553, 43.537688 ],
            [ 6.467455, 43.537619 ],
            [ 6.467335, 43.537552 ],
            [ 6.467374, 43.537522 ],
            [ 6.467506, 43.537596 ],
            [ 6.467593, 43.537656 ],
            [ 6.467553, 43.537688 ]
          ]],
   "43"    : [[
            [ 6.467639, 43.537888 ],
            [ 6.4674934, 43.5378241 ],
            [ 6.4675336, 43.5377914 ],
            [ 6.467674, 43.537853 ],
            [ 6.467639, 43.537888 ]
          ]],
   "44"    : [[
            [ 6.467593, 43.537656 ],
            [ 6.467506, 43.537596 ],
            [ 6.467374, 43.537522 ],
            [ 6.467456, 43.53746 ],
            [ 6.467667, 43.537594 ],
            [ 6.467651, 43.537606 ],
            [ 6.467593, 43.537656 ]
          ]],
   "45"    : [[
            [ 6.467747, 43.537948 ],
            [ 6.467642, 43.537889 ],
            [ 6.467639, 43.537888 ],
            [ 6.467674, 43.537853 ],
            [ 6.4675336, 43.5377914 ],
            [ 6.4675724, 43.5377576 ],
            [ 6.467718, 43.537823 ],
            [ 6.467825, 43.537885 ],
            [ 6.467747, 43.537948 ]
          ]],
   "47"    : [[
            [ 6.4676133, 43.5377233 ],
            [ 6.467769, 43.5378 ],
            [ 6.46786, 43.537857 ],
            [ 6.467825, 43.537885 ],
            [ 6.467718, 43.537823 ],
            [ 6.4675724, 43.5377576 ],
            [ 6.4676133, 43.5377233 ]
          ]],
   "48"    : [[
            [ 6.467709, 43.537561 ],
            [ 6.467494, 43.537429 ],
            [ 6.467533, 43.537393 ],
            [ 6.467669, 43.537477 ],
            [ 6.467746, 43.537524 ],
            [ 6.467741, 43.5375292 ],
            [ 6.467716, 43.537555 ],
            [ 6.467709, 43.537561 ]
          ]],
   "49"    : [[
            [ 6.467769, 43.5378 ],
            [ 6.4676133, 43.5377233 ],
            [ 6.4676523, 43.5376909 ],
            [ 6.46781, 43.537761 ],
            [ 6.467769, 43.5378 ]
          ]],
   "50"    : [[
            [ 6.467707, 43.537441 ],
            [ 6.467708, 43.537442 ],
            [ 6.467783, 43.537486 ],
            [ 6.467746, 43.537524 ],
            [ 6.467669, 43.537477 ],
            [ 6.467707, 43.537441 ]
          ]],
   "51"    : [[
            [ 6.46781, 43.537761 ],
            [ 6.4676523, 43.5376909 ],
            [ 6.467694, 43.5376558 ],
            [ 6.4677631, 43.5376871 ],
            [ 6.467843, 43.5377236 ],
            [ 6.467879, 43.537747 ],
            [ 6.467842, 43.537778 ],
            [ 6.467819, 43.537765 ],
            [ 6.46781, 43.537761 ]
          ]],
   "53"    : [[
            [ 6.4677703, 43.5376042 ],
            [ 6.467923, 43.537675 ],
            [ 6.4678764, 43.5377146 ],
            [ 6.467732, 43.5376458 ],
            [ 6.4677703, 43.5376042 ]
          ]],
   "57"    : [[
            [ 6.4678267, 43.5375434 ],
            [ 6.46791, 43.537584 ],
            [ 6.467888, 43.537609 ],
            [ 6.467805, 43.5375674 ],
            [ 6.4678267, 43.5375434 ]
          ]],
   "61"    : [[
            [ 6.46791, 43.537584 ],
            [ 6.4678267, 43.5375434 ],
            [ 6.467835, 43.5375346 ],
            [ 6.467917, 43.537576 ],
            [ 6.46791, 43.537584 ]
          ]],
   "63"    : [[
            [ 6.468039, 43.537585 ],
            [ 6.467868, 43.5375012 ],
            [ 6.467969, 43.5373968 ],
            [ 6.468068, 43.537443 ],
            [ 6.468041, 43.537473 ],
            [ 6.468212, 43.537548 ],
            [ 6.468282, 43.537484 ],
            [ 6.468318, 43.537499 ],
            [ 6.468257, 43.537553 ],
            [ 6.468168, 43.537618 ],
            [ 6.468153, 43.53763 ],
            [ 6.468049, 43.537576 ],
            [ 6.468039, 43.537585 ]
          ]],
   "65"    : [[
            [ 6.46815, 43.53742 ],
            [ 6.468121, 43.537467 ],
            [ 6.468068, 43.537443 ],
            [ 6.467969, 43.5373968 ],
            [ 6.467995, 43.5373605 ],
            [ 6.468095, 43.537394 ],
            [ 6.468112, 43.5374 ],
            [ 6.468117, 43.537402 ],
            [ 6.46815, 43.53742 ]
          ]]
 },
 "marchands" : {
   "1"  : [[
            [ 6.466366, 43.538562 ],
            [ 6.466467, 43.538604 ],
            [ 6.466423, 43.538655 ],
            [ 6.466339, 43.538613 ],
            [ 6.466359, 43.538586 ],
            [ 6.466351, 43.538582 ],
            [ 6.466366, 43.538562 ]
          ]],
   "2"  : [[
            [ 6.466358, 43.538679 ],
            [ 6.466281, 43.538786 ],
            [ 6.466206, 43.538746 ],
            [ 6.466235, 43.538713 ],
            [ 6.466287, 43.538645 ],
            [ 6.466358, 43.538679 ]
          ]],
   "3"  : [[
            [ 6.466236, 43.538381 ],
            [ 6.466256, 43.538417 ],
            [ 6.466265, 43.538458 ],
            [ 6.466263, 43.538519 ],
            [ 6.466263, 43.538573 ],
            [ 6.466185, 43.53855 ],
            [ 6.466195, 43.53845 ],
            [ 6.46619, 43.538423 ],
            [ 6.466111, 43.538433 ],
            [ 6.46611, 43.538389 ],
            [ 6.466177, 43.538385 ],
            [ 6.466236, 43.538381 ]
          ]],
   "4"  : [[
            [ 6.466136, 43.538722 ],
            [ 6.466226, 43.538617 ],
            [ 6.466287, 43.538645 ],
            [ 6.466235, 43.538713 ],
            [ 6.466206, 43.538746 ],
            [ 6.466175, 43.538756 ],
            [ 6.466148, 43.538795 ],
            [ 6.466087, 43.538768 ],
            [ 6.466136, 43.538722 ]
          ]],
   "6"  : [[
            [ 6.466037, 43.538672 ],
            [ 6.46612, 43.538565 ],
            [ 6.466226, 43.538617 ],
            [ 6.466136, 43.538722 ],
            [ 6.466039, 43.538673 ],
            [ 6.466037, 43.538672 ]
          ]], // a verifier sur le site
   "7"  : [[
            [ 6.466185, 43.53855 ],
            [ 6.466107, 43.538504 ],
            [ 6.4661, 43.538456 ],
            [ 6.466103, 43.538433 ],
            [ 6.466111, 43.538433 ],
            [ 6.46619, 43.538423 ],
            [ 6.466195, 43.53845 ],
            [ 6.466185, 43.53855 ]
          ]],
   "8"  : [[
            [ 6.465972, 43.538638 ],
            [ 6.466063, 43.538539 ],
            [ 6.46612, 43.538565 ],
            [ 6.466037, 43.538672 ],
            [ 6.465972, 43.538638 ]
         ]],
   "9"  : [[
            [ 6.466045, 43.538452 ],
            [ 6.466036, 43.538405 ],
            [ 6.466053, 43.538372 ],
            [ 6.46603, 43.538302 ],
            [ 6.466089, 43.538292 ],
            [ 6.466099, 43.538326 ],
            [ 6.466107, 43.538358 ],
            [ 6.46611, 43.538389 ],
            [ 6.466111, 43.538433 ],
            [ 6.466103, 43.538433 ],
            [ 6.4661, 43.538456 ],
            [ 6.466045, 43.538452 ]
          ]],
   "10" : [[
            [ 6.465918, 43.53862 ],
            [ 6.465912, 43.538486 ],
            [ 6.465978, 43.5385 ],
            [ 6.466063, 43.538539 ],
            [ 6.465972, 43.538638 ],
            [ 6.465931, 43.538616 ],
            [ 6.465918, 43.53862 ]
          ]],
   "11" : [[
            [ 6.46603, 43.538302 ],
            [ 6.466053, 43.538372 ],
            [ 6.466036, 43.538405 ],
            [ 6.466045, 43.538452 ],
            [ 6.46603, 43.53845 ],
            [ 6.465981, 43.538447 ],
            [ 6.465974, 43.538353 ],
            [ 6.465972, 43.538312 ],
            [ 6.465988, 43.538308 ],
            [ 6.465971, 43.538266 ],
            [ 6.466006, 43.53826 ],
            [ 6.466008, 43.538264 ],
            [ 6.466016, 43.538263 ],
            [ 6.46603, 43.538302 ]
          ]],
/*   "12" : [[
            [ 6.465918, 43.53862 ],
            [ 6.465912, 43.538486 ],
            [ 6.465978, 43.5385 ],
            [ 6.466063, 43.538539 ],
            [ 6.465972, 43.538638 ],
            [ 6.465931, 43.538616 ],
            [ 6.465918, 43.53862 ]
          ]], */
   "13" : [[
            [ 6.465914, 43.538443 ],
            [ 6.465899, 43.538366 ],
            [ 6.465974, 43.538353 ],
            [ 6.465981, 43.538447 ],
            [ 6.465914, 43.538443 ]
          ]],
   "14" :  [[
            [ 6.465912, 43.538486 ],
            [ 6.465918, 43.53862 ],
            [ 6.465889, 43.53863 ],
            [ 6.465856, 43.538475 ],
            [ 6.465865, 43.538475 ],
            [ 6.465912, 43.538486 ]
          ]]
 },
 "marche" : {
   "27"    : [[
            [ 6.465756, 43.538485 ],
            [ 6.465785, 43.538665 ],
            [ 6.465767, 43.538667 ],
            [ 6.46576, 43.538666 ],
            [ 6.465755, 43.538664 ],
            [ 6.46575, 43.538664 ],
            [ 6.465744, 43.53866 ],
            [ 6.465737, 43.538653 ],
            [ 6.46573, 43.538644 ],
            [ 6.465719, 43.538649 ],
            [ 6.465717, 43.538625 ],
            [ 6.465713, 43.538591 ],
            [ 6.465704, 43.538491 ],
            [ 6.465756, 43.538485 ]
          ]],
   "31"    : [[
            [ 6.465899, 43.538366 ],
            [ 6.465914, 43.538443 ],
            [ 6.465802, 43.538428 ],
            [ 6.465788, 43.538384 ],
            [ 6.465899, 43.538366 ]
          ]]
 },
 "herbes" : {
   "1"  : [[
            [ 6.466655, 43.538749 ],
            [ 6.466727, 43.538664 ],
            [ 6.466699, 43.538652 ],
            [ 6.4667301, 43.5386179 ],
            [ 6.466836, 43.538664 ],
            [ 6.466819, 43.538679 ],
            [ 6.466718, 43.538772 ],
            [ 6.466655, 43.538749 ]
          ]],
   "2"  : [[
            [ 6.466553, 43.538944 ],
            [ 6.466637, 43.538844 ],
            [ 6.466731, 43.538894 ],
            [ 6.466626, 43.538993 ],
            [ 6.466608, 43.538981 ],
            [ 6.466553, 43.538944 ]
          ]],
   "3"  : [[
            [ 6.4667301, 43.5386179 ],
            [ 6.466699, 43.538652 ],
            [ 6.466727, 43.538664 ],
            [ 6.466655, 43.538749 ],
            [ 6.466644, 43.538744 ],
            [ 6.466584, 43.538724 ],
            [ 6.466618, 43.538683 ],
            [ 6.466657, 43.538635 ],
            [ 6.466687, 43.5385991 ],
            [ 6.4667301, 43.5386179 ]
          ]],
   "4"  : [[
            [ 6.466608, 43.538981 ],
            [ 6.466581, 43.539012 ],
            [ 6.466563, 43.539003 ],
            [ 6.466546, 43.539022 ],
            [ 6.46654, 43.539018 ],
            [ 6.466476, 43.538992 ],
            [ 6.466529, 43.538928 ],
            [ 6.466553, 43.538944 ],
            [ 6.466608, 43.538981 ]
          ]],
   "5"  : [[
            [ 6.466584, 43.538724 ],
            [ 6.466551, 43.538713 ],
            [ 6.466462, 43.538681 ],
            [ 6.466499, 43.538637 ],
            [ 6.466618, 43.538683 ],
            [ 6.466584, 43.538724 ]
          ]], 
   "6"  : [[
            [ 6.466529, 43.538928 ],
            [ 6.466476, 43.538992 ],
            [ 6.466432, 43.538973 ],
            [ 6.46649, 43.538904 ],
            [ 6.466529, 43.538928 ]
          ]],
   "7"  : [[
            [ 6.466358, 43.538679 ],
            [ 6.466405, 43.538702 ],
            [ 6.466328, 43.538799 ],
            [ 6.466366, 43.538823 ],
            [ 6.466357, 43.53883 ],
            [ 6.466331, 43.538857 ],
            [ 6.466321, 43.538851 ],
            [ 6.466278, 43.538824 ],
            [ 6.46626, 43.538815 ],
            [ 6.466281, 43.538786 ],
            [ 6.466358, 43.538679 ]
          ]],
   "8"  : [[
            [ 6.466432, 43.538973 ],
            [ 6.466369, 43.538946 ],
            [ 6.466323, 43.538923 ],
            [ 6.4664, 43.538854 ],
            [ 6.466446, 43.538878 ],
            [ 6.46649, 43.538904 ],
            [ 6.466432, 43.538973 ]
          ]],
//   "10" : [6.466408, 43.538879],
   "12" : [[
            [ 6.4664, 43.538854 ],
            [ 6.466323, 43.538923 ],
            [ 6.466321, 43.538922 ],
            [ 6.466275, 43.538895 ],
            [ 6.466321, 43.538851 ],
            [ 6.466331, 43.538857 ],
            [ 6.466357, 43.53883 ],
            [ 6.4664, 43.538854 ]
          ]]
 }
},

/* contient, pour chaque periode,
 * les infos de chaque batiment pour chaque rue.
 * Sert a remplir les info bulle pour chaque epoque
 */
eraLayers = {
  "Contemporain" : {
    "trans" : {
      "4"  : "Dog Station",
      "7"  : "Intemporel D√©co",
     // "9"  : "Caboch'Arts",
      "14" : "Au relieur",
      "19" : "Elephant Knives coutelier",
      "21" : "L'atelier des Nanas",
      "23" : "L'atelier de Myr",
      "27" : "Smart Candle 83",
      "28" : "Dracart",
      "30" : "Le k-f√© invent√©",
      "31" : "Ludo Ado Cuir",
      "33" : "Atelier Photos",
      "34" : "Les Allum√©s d'Arts",
      "36" : "Magasin Oriental",
      "38" : "Les potiront",
      "43" : "le petit atelier de couture",
      "45" : "Atelier 45 Philippe Rossi Sculpteur",
      "65" : "Cayssials Tennis",
    },
    "marchands" : {
      "4"  : "Ribambelle et Co",
 //     "12" : "Boucherie traiteur Michel Fr√®res",
      "14" : "Petite Agerola",
    },
    "marche" : {
      "27" : "Boucherie Labat",
      "31" : "Bar-Tabac Le Marigny Loto"
    },
    "herbes" : {
      "2"  : "Les 1000 Colonnes Bar Restaurant",
      "3"  : "Tatoo Look",
      "7"  : "Pharmacie Herboristerie Reybaud",
      "8"  : "L'homme by S",
      "12" : "Anh Dao Traiteur",
    },
  },
  "Moderne" : {
    "trans" : {
       "2"  : "Bar ¬´la rotonde¬ª",
       "3"  : "Fromagerie",
       "4"  : "Magasin de p√¢tes Marie Gar√ßin",
      // "5"  : "Coiffeur pour dames ¬´ Vartan ¬ª", 
       "6"  : "Restaurant ¬´ la ni√ßoise ¬ª",
       "8"  : "Triperie ¬´ Pastouret ¬ª",
      "10"  : "Tailleur ¬´ Tito Nannelli ¬ª",
      "12"  : "Imprimerie Garcin",
      "14"  : "Epicier ¬´ Minas ¬ª",
      "19"  : "Vins ¬´ Forni ¬ª",
      "20"  : "Torr√©faction", 
      "21"  : "Epicerie ¬´ Gastaldi ¬ª",
      "23"  : "Coutelier aiguiseur ¬´ Provido ¬ª",
      "24"  : "Epicerie ¬´ chez mme COLLE¬ª",
      "26"  : "Boulangerie ¬´ Pelissier ¬ª", 
      "28"  : "Coiffeur ¬´ Victor ¬ª",
      "30"  : "Le chevillard Lyonnais ¬´ Guenon ¬ª",
      "31"  : "Ferailleur chiffonnier ¬´ Marsiglia ¬ª", 
      "33"  : "Tourneur sur bois ¬´ Martinoli ¬ª",
      "34"  : "Cordonnier ¬´ Grisollia ¬ª",
      "34B" : "Epicerie ¬´ A.Romey ¬ª",
      "36"  : "Cin√©ma ambulant ¬´ Foucou ¬ª", 
      "38"  : "Epicerie Rossi",
      "43"  : "Etameur ¬´ Passerin ¬ª",
      "45"  : "Cordonnier ¬´ Pellutiero ¬ª",
      "48"  : "Tailleur ¬´ J.Jangotchiant ¬ª",
      "61"  : "bar ¬´ le bon jus ¬ª",
      "63"  : "bar ¬´ le bon jus ¬ª",
      "65"  : "Cordage Tennis",
    },
    "marchands" : {
       "2" : "Pharmacie ¬´ Reboul ¬ª",
       "3" : "Radios et disques ¬´ Fabre ¬ª",
       "4" : "Coiffeur pour dames ¬´ Gauthier ¬ª",
       "6" : "Bottier ¬´ ARAM ¬ª",
       "7" : "Quincallerie ¬´ GOIRAND ¬ª entrep√¥t",
       "8" : "Mercerie chez ¬´ TITINE ¬ª",
       "9" : "Quincailler ¬´ GOIRAND ¬ª Vente",
      "10" : "Opticien Auguste Grel",
      "11" : "Repasseuse Marzet",
     // "12" : "Machines √† √©crire ¬´ PREJEAN ¬ª",
      "14" : "Epicerie DEMAZIERES",
    },
    "herbes" : {
      "1" : "Boulangerie ¬´ Albissier ¬ª",
      "2" : "Le caf√© des mille colonnes",
      "3" : "Bar tabac",
      "4" : "Murisserie bananes",
      "5" : "Mercerie ¬´ PRAT ¬ª",
      "7" : "Magasin electricit√© ¬´ RAMONDA ¬ª",
      "8" : "Chaussures ¬´ BOZABALIAN ¬ª",
    },
  },
  "Historique"   : {
    "trans" : {
      "2" : "maison Revaute",
      "3" : "maison Surle",
      "4" : "maison Ferrier",
   //   "5" : "maison Cavasse",
      "6" : "maison Bonnet",
      "7" : "maison Andre",
      "8" : "maison Gues",
 //     "9" : "maison Giboin",
      "10" : "maison Provido",
      "12" : "maison Donadey",
      "14" : "maison Donadey",
      "18" : "maison Negro",
      "20" : "maison Bellon",
      "21" : "maison Saglietto",
      "22" : "maison Vassal",
      "24" : "maison Ferraud",
      "28" : "maison Maunier",
   //   "32" : "maison Truc",
      "34" : "hotellerie Fleur de Lys",
      "38" : "maison Fauchat",
      "42" : "maison Clavier",
      "44" : "maison Reboul",
      "47" : "maison Cavalier",
      "48" : "maison Imbert",
      "49" : "maison Giraud",
      "50" : "maison Giran",
      "51" : "maison Pellenq",
      "53" : "maison Ricard",
      "57" : "maison Casimir",
      "61" : "hostellerie Tete d'Or",
      "63" : "hostellerie Tete d'Or",
    },
    "marchands" : {
       "1" : "maison Granet",
       "2" : "maison Digites",
       "3" : "maison Caussemille",
       "4" : "maison Barbaroux",
       "6" : "maison Reboul",
       "7" : "maison Laugier",
       "8" : "maison Clavel",
       "9" : "maison Cadish",
      "10" : "maison Giraud",
      "11" : "maison Sivan",
 //     "12" : "maison Sivan",
      "13" : "maison Missimilly"
    },
    "herbes" : {
      "1" : "maison Vintimille",
      "2" : "auberge des 3 Rois",
      "3" : "maison Chabaud",
      "4" : "maison Castel",
      "5" : "maison Faucachon",
      "7" : "maison Missimilly",
      "8" : "maison Gal",
    }
  }
};